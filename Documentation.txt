# ğŸ“š **RestoManagerKe - Complete System Documentation**

## **Developer Information**
- **Developer**: Davix HDM
- **Email**: davismcintyre5@gmail.com
- **Phone**: 0768784909
- **System**: RestoManagerKe - Complete Restaurant Management System
- **Version**: 3.0.0
- **Last Updated**: February 2026

---

## ğŸ“‹ **Table of Contents**
1. [System Overview](#system-overview)
2. [Technology Stack](#technology-stack)
3. [System Architecture](#system-architecture)
4. [Installation Guide](#installation-guide)
5. [Database Schema](#database-schema)
6. [API Documentation](#api-documentation)
7. [Frontend Modules](#frontend-modules)
8. [User Roles & Permissions](#user-roles--permissions)
9. [M-PESA Integration](#m-pesa-integration)
10. [Customer Portal](#customer-portal)
11. [Troubleshooting](#troubleshooting)
12. [Support & Contact](#support--contact)

---

## **System Overview**

RestoManagerKe is a comprehensive restaurant management system designed specifically for Kenyan restaurants. It provides end-to-end solutions for managing restaurant operations including menu management, order processing, table reservations, inventory tracking, employee management, payroll processing, expense tracking, and real-time analytics.

### **Key Features**
- âœ… **Dashboard** - Real-time analytics and statistics
- âœ… **Menu Management** - CRUD operations for menu items
- âœ… **Order Management** - Process and track customer orders
- âœ… **Table Reservations** - Book and manage table reservations
- âœ… **Inventory Management** - Track stock levels and usage
- âœ… **Supplier Management** - Manage supplier information
- âœ… **Employee Management** - Staff records and management
- âœ… **Payroll Processing** - Calculate and process salaries
- âœ… **Expense Tracking** - Record and monitor expenses
- âœ… **Sales Transactions** - Record point-of-sale transactions
- âœ… **Customer Management** - Customer database with history
- âœ… **M-PESA Integration** - Mobile money payments
- âœ… **Customer Portal** - Online ordering and reservations
- âœ… **Reports Generation** - Sales, expense, inventory reports

---

## **Technology Stack**

| Layer | Technology | Version |
|-------|------------|---------|
| **Frontend** | HTML5, CSS3, JavaScript | ES6+ |
| **Backend** | Node.js | v18+ |
| **Framework** | Express.js | 4.18+ |
| **Database** | MongoDB | 6.0+ |
| **ODM** | Mongoose | 7.5+ |
| **Authentication** | JWT | 9.0+ |
| **Password Hashing** | bcryptjs | 2.4+ |
| **API Style** | RESTful | - |
| **Payment Gateway** | M-PESA Daraja API | - |
| **Icons** | Font Awesome | 6.0 |
| **Fonts** | Google Fonts (Inter) | - |
| **Charts** | Chart.js | 4.4 |

---

## **System Architecture**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLIENT LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Dashboard       â”‚          Customer Portal                 â”‚
â”‚   (index.html)    â”‚          (customer-portal.html)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        API LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Express.js Server with JWT Authentication                  â”‚
â”‚   Routes: /api/auth, /api/menu, /api/orders, etc.           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     DATA LAYER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    MongoDB Database                           â”‚
â”‚        Collections: users, menuItems, orders, etc.          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    INTEGRATIONS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    M-PESA Daraja API                         â”‚
â”‚                    (Payment Processing)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## **Installation Guide**

### **Prerequisites**
- Node.js (v18 or higher)
- MongoDB (v6.0 or higher)
- npm or yarn package manager
- Git (optional)
- M-PESA Developer Account (for payments)

### **Step 1: Clone Repository**
```bash
git clone https://github.com/davixhdm/restomanagerke.git
cd restomanagerke
```

### **Step 2: Install Dependencies**
```bash
npm install
```

### **Step 3: Configure Environment Variables**
Create a `.env` file in the root directory:

```env
# ============= SERVER CONFIGURATION =============
NODE_ENV=development
PORT=5000

# ============= DATABASE =============
MONGODB_URI=mongodb://localhost:27017/restomanagerke

# ============= JWT AUTHENTICATION =============
JWT_SECRET=your_super_secure_jwt_secret_key
JWT_EXPIRE=7d

# ============= ADMIN CREDENTIALS =============
ADMIN_EMAIL=davismcintyre5@gmail.com
ADMIN_PASSWORD=Hdm@2002
ADMIN_NAME=Admin User

# ============= M-PESA API =============
MPESA_ENVIRONMENT=sandbox
MPESA_CONSUMER_KEY=your_consumer_key
MPESA_CONSUMER_SECRET=your_consumer_secret
MPESA_BUSINESS_SHORTCODE=174379
MPESA_PASSKEY=your_passkey
MPESA_CALLBACK_URL=https://yourdomain.com/api/mpesa/callback

# ============= CORS =============
CORS_ORIGIN=http://localhost:5000,http://127.0.0.1:5000
```

### **Step 4: Start MongoDB**
```bash
# Windows
mongod

# Linux/Mac
sudo systemctl start mongod
```

### **Step 5: Seed Database**
```bash
node seed.js
```

### **Step 6: Start Server**
```bash
# Development mode
npm run dev

# Production mode
npm start
```

### **Step 7: Access Application**
- **Dashboard**: `http://localhost:5000/dashboard`
- **Customer Portal**: `http://localhost:5000/order`
- **API Root**: `http://localhost:5000/api`

### **Default Login Credentials**
```
Email:    davismcintyre5@gmail.com
Password: Hdm@2002
Role:     Admin
```

---

## **Database Schema**

### **Collections Overview**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚       â”‚   menuItems     â”‚       â”‚     orders      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id             â”‚       â”‚ _id             â”‚       â”‚ _id             â”‚
â”‚ name            â”‚       â”‚ menuId          â”‚       â”‚ orderNumber     â”‚
â”‚ email           â”‚       â”‚ name            â”‚       â”‚ customerName    â”‚
â”‚ password        â”‚       â”‚ category        â”‚       â”‚ customerPhone   â”‚
â”‚ role            â”‚       â”‚ price           â”‚       â”‚ items[]         â”‚
â”‚ isActive        â”‚       â”‚ available       â”‚       â”‚ subtotal        â”‚
â”‚ createdAt       â”‚       â”‚ preparationTime â”‚       â”‚ total           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ image           â”‚       â”‚ orderStatus     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ paymentStatus   â”‚
                                                    â”‚ createdAt       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  reservations   â”‚       â”‚   inventory     â”‚      
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ _id             â”‚       â”‚ _id             â”‚       â”‚   suppliers     â”‚
â”‚ name            â”‚       â”‚ name            â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ phone           â”‚       â”‚ category        â”‚       â”‚ _id             â”‚
â”‚ guests          â”‚       â”‚ quantity        â”‚       â”‚ name            â”‚
â”‚ date            â”‚       â”‚ unit            â”‚       â”‚ contactPerson   â”‚
â”‚ time            â”‚       â”‚ unitPrice       â”‚       â”‚ phone           â”‚
â”‚ status          â”‚       â”‚ reorderLevel    â”‚       â”‚ email           â”‚
â”‚ createdAt       â”‚       â”‚ status          â”‚       â”‚ products        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ supplier        â”‚       â”‚ paymentTerms    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    employees    â”‚       â”‚     payroll      â”‚       â”‚    expenses     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id             â”‚       â”‚ _id             â”‚       â”‚ _id             â”‚
â”‚ employeeId      â”‚       â”‚ employeeId      â”‚       â”‚ expenseId       â”‚
â”‚ name            â”‚       â”‚ employeeName    â”‚       â”‚ type            â”‚
â”‚ position        â”‚       â”‚ payPeriod       â”‚       â”‚ description     â”‚
â”‚ department      â”‚       â”‚ baseSalary      â”‚       â”‚ amount          â”‚
â”‚ email           â”‚       â”‚ hoursWorked     â”‚       â”‚ paymentMethod   â”‚
â”‚ phone           â”‚       â”‚ overtimePay     â”‚       â”‚ supplier        â”‚
â”‚ salary          â”‚       â”‚ totalPay        â”‚       â”‚ createdAt       â”‚
â”‚ status          â”‚       â”‚ status          â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ paymentDate     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  transactions   â”‚       â”‚  notifications  â”‚       â”‚   customers     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id             â”‚       â”‚ _id             â”‚       â”‚ _id             â”‚
â”‚ transactionId   â”‚       â”‚ title           â”‚       â”‚ customerId      â”‚
â”‚ customerName    â”‚       â”‚ message         â”‚       â”‚ name            â”‚
â”‚ items[]         â”‚       â”‚ type            â”‚       â”‚ email           â”‚
â”‚ total           â”‚       â”‚ read            â”‚       â”‚ password        â”‚
â”‚ paymentMethod   â”‚       â”‚ createdAt       â”‚       â”‚ phone           â”‚
â”‚ createdAt       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ address         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚ totalOrders     â”‚
                                                     â”‚ totalSpent      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚ memberSince     â”‚
â”‚   restaurants   â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id             â”‚
â”‚ name            â”‚
â”‚ address         â”‚
â”‚ phone           â”‚
â”‚ email           â”‚
â”‚ kraPin          â”‚
â”‚ watermark       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## **API Documentation**

### **Base URL**
```
http://localhost:5000/api
```

### **Authentication Endpoints**

#### **POST /auth/login**
Login user and receive JWT token.

**Request Body:**
```json
{
  "email": "davismcintyre5@gmail.com",
  "password": "Hdm@2002"
}
```

**Response:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "user": {
    "_id": "65f1a2b3c4d5e6f7a8b9c0d1",
    "name": "Admin User",
    "email": "davismcintyre5@gmail.com",
    "role": "admin"
  }
}
```

#### **GET /auth/me**
Get current user information.

**Headers:**
```
Authorization: Bearer <token>
```

#### **POST /auth/change-password**
Change user password.

**Headers:**
```
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "currentPassword": "oldpassword",
  "newPassword": "newpassword123"
}
```

### **Menu Endpoints**

#### **GET /menu**
Get all menu items (admin only).

#### **GET /menu/available**
Get available menu items (public).

#### **GET /menu/:id**
Get single menu item.

#### **POST /menu**
Create new menu item.

**Request Body:**
```json
{
  "name": "Nyama Choma",
  "category": "Main Course",
  "price": 800,
  "description": "Grilled meat with kachumbari",
  "preparationTime": 20,
  "image": "fa-drumstick-bite"
}
```

#### **PUT /menu/:id**
Update menu item.

#### **PATCH /menu/:id/toggle**
Toggle item availability.

#### **DELETE /menu/:id**
Delete menu item.

### **Orders Endpoints**

#### **GET /orders**
Get all orders (admin only).

#### **GET /orders/my-orders**
Get current customer's orders.

#### **GET /orders/track/:orderNumber**
Track order by number.

#### **POST /orders**
Create new order (requires login).

**Request Body:**
```json
{
  "items": [
    {
      "menuItemId": "65f1a2b3c4d5e6f7a8b9c0d2",
      "quantity": 2
    }
  ],
  "orderType": "takeaway",
  "paymentMethod": "M-PESA"
}
```

#### **PATCH /orders/:id/status**
Update order status (admin only).

#### **DELETE /orders/:id**
Delete order (admin only).

### **Reservations Endpoints**

#### **GET /reservations**
Get all reservations (admin only).

#### **GET /reservations/today**
Get today's reservations.

#### **GET /reservations/slots/:date**
Get available time slots.

#### **POST /reservations**
Create reservation (requires login).

**Request Body:**
```json
{
  "guests": 4,
  "date": "2026-03-01",
  "time": "19:00",
  "requests": "Birthday celebration"
}
```

#### **PATCH /reservations/:id/status**
Update reservation status.

### **M-PESA Endpoints**

#### **GET /mpesa/test**
Test M-PESA configuration.

#### **POST /mpesa/stkpush**
Initiate STK Push payment.

**Request Body:**
```json
{
  "phone": "254712345678",
  "amount": 800,
  "accountReference": "ORDER123"
}
```

#### **POST /mpesa/query**
Query payment status.

### **Dashboard Endpoints**

#### **GET /dashboard/stats**
Get dashboard statistics.

**Response:**
```json
{
  "todayRevenue": 45000,
  "todayExpenses": 12000,
  "accountBalance": 33000,
  "lowStockCount": 3,
  "todayOrders": 15,
  "todayReservations": 8
}
```

### **Inventory Endpoints**

#### **GET /inventory**
Get all inventory items.

#### **GET /inventory/low-stock**
Get low stock items.

#### **POST /inventory**
Add inventory item.

#### **POST /inventory/:id/use**
Record stock usage.

#### **POST /inventory/:id/reorder**
Create reorder request.

### **Suppliers Endpoints**

#### **GET /suppliers**
Get all suppliers.

#### **POST /suppliers**
Add new supplier.

#### **PUT /suppliers/:id**
Update supplier.

#### **DELETE /suppliers/:id**
Delete supplier.

### **Employees Endpoints**

#### **GET /employees**
Get all employees.

#### **POST /employees**
Add employee.

#### **PUT /employees/:id**
Update employee.

#### **DELETE /employees/:id**
Delete employee.

### **Payroll Endpoints**

#### **GET /payroll**
Get payroll records.

#### **POST /payroll**
Process payroll.

#### **PATCH /payroll/:id/pay**
Mark payroll as paid.

#### **POST /payroll/pay-all**
Pay all pending salaries.

### **Expenses Endpoints**

#### **GET /expenses**
Get all expenses.

#### **POST /expenses**
Record expense.

#### **DELETE /expenses/:id**
Delete expense.

### **Transactions Endpoints**

#### **GET /transactions**
Get all transactions.

#### **POST /transactions**
Create new transaction.

### **Notifications Endpoints**

#### **GET /notifications/unread**
Get unread notifications.

#### **PATCH /notifications/:id/read**
Mark notification as read.

### **Restaurant Settings Endpoints**

#### **GET /restaurant**
Get restaurant settings.

#### **PUT /restaurant**
Update restaurant settings.

### **Customer Authentication Endpoints**

#### **POST /customer/auth/register**
Register new customer.

**Request Body:**
```json
{
  "name": "John Doe",
  "email": "john@example.com",
  "password": "password123",
  "phone": "0712345678",
  "address": "Nairobi, Kenya"
}
```

#### **POST /customer/auth/login**
Login customer.

#### **GET /customer/auth/me**
Get customer profile.

#### **POST /customer/auth/forgot-password**
Request password reset.

#### **POST /customer/auth/reset-password**
Reset password with token.

### **Reports Endpoints**

#### **GET /reports/sales**
Generate sales report.

#### **GET /reports/expenses**
Generate expense report.

#### **GET /reports/inventory**
Generate inventory report.

#### **GET /reports/payroll**
Generate payroll report.

#### **GET /reports/general**
Generate general restaurant report.

---

## **Frontend Modules**

### **Dashboard Module**
- Real-time statistics display
- Revenue tracking
- Expense monitoring
- Low stock alerts
- Recent activities feed
- Sales charts

### **Menu Management Module**
- Add/Edit/Delete menu items
- Category management
- Price updates
- Availability toggling
- Print menu functionality

### **Orders Module**
- View all orders
- Filter by status
- Update order status
- Print orders
- View order details
- Payment confirmation

### **Reservations Module**
- View all reservations
- Mark as seated
- Cancel with reason
- View reservation details
- Filter active reservations

### **Inventory Module**
- Stock level tracking
- Low stock alerts
- Usage recording
- Reorder requests
- Supplier linking

### **Suppliers Module**
- Supplier directory
- Contact management
- Product catalog
- Payment terms

### **Employees Module**
- Employee records
- Department assignment
- Salary management
- Status tracking

### **Payroll Module**
- Process payroll
- Calculate overtime
- Add bonuses/deductions
- Mark as paid
- Print payslips

### **Expenses Module**
- Record expenses
- Categorize expenses
- Payment method tracking
- Supplier linking

### **Transactions Module**
- Record sales
- Itemized billing
- Multiple payment methods
- Receipt printing

### **Customers Module**
- Customer database
- Order history
- Total spent tracking
- Contact management

### **Reports Module**
- Sales reports
- Expense reports
- Inventory reports
- Payroll reports
- General restaurant reports

### **Customer Portal**
- Menu browsing
- Online ordering
- M-PESA payments
- Table reservations
- Order tracking
- Order history
- User profile management

---

## **User Roles & Permissions**

| Role | Description | Permissions |
|------|-------------|-------------|
| **Admin** | Full system access | All modules, user management, settings |
| **Manager** | Operational management | All modules except user management |
| **Cashier** | Sales and transactions | View menu, process sales, view inventory |
| **Staff** | Basic read-only | View menu, inventory, basic info |
| **Customer** | Portal user | Place orders, make reservations, view history |

### **Permissions Matrix**

| Module | Action | Admin | Manager | Cashier | Staff | Customer |
|--------|--------|-------|---------|---------|-------|----------|
| **Dashboard** | View | âœ… | âœ… | âœ… | âœ… | âŒ |
| **Menu** | View | âœ… | âœ… | âœ… | âœ… | âœ… |
| | Create/Edit | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Delete | âœ… | âŒ | âŒ | âŒ | âŒ |
| **Orders** | View All | âœ… | âœ… | âœ… | âŒ | âŒ |
| | View Own | âŒ | âŒ | âŒ | âŒ | âœ… |
| | Create | âŒ | âŒ | âœ… | âŒ | âœ… |
| | Update Status | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Reservations** | View All | âœ… | âœ… | âœ… | âŒ | âŒ |
| | Create Own | âŒ | âŒ | âŒ | âŒ | âœ… |
| | Update | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Inventory** | View | âœ… | âœ… | âœ… | âœ… | âŒ |
| | Create/Edit | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Delete | âœ… | âŒ | âŒ | âŒ | âŒ |
| **Suppliers** | View | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Create/Edit | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Employees** | View | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Create/Edit | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Payroll** | View | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Process | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Expenses** | View | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Create | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Transactions** | View All | âœ… | âœ… | âœ… | âŒ | âŒ |
| | Create | âœ… | âœ… | âœ… | âŒ | âŒ |
| **Customers** | View | âœ… | âœ… | âŒ | âŒ | âŒ |
| | Manage | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Reports** | Generate | âœ… | âœ… | âŒ | âŒ | âŒ |
| **Users** | Manage | âœ… | âŒ | âŒ | âŒ | âŒ |
| **Settings** | Configure | âœ… | âŒ | âŒ | âŒ | âŒ |

---

## **M-PESA Integration**

### **Overview**
RestoManagerKe integrates with Safaricom's M-PESA Daraja API for mobile money payments. Customers can pay for orders directly from their phones.

### **Configuration**

#### **Step 1: Get M-PESA Credentials**
1. Register at [Safaricom Developer Portal](https://developer.safaricom.co.ke/)
2. Create an app to get Consumer Key and Consumer Secret
3. For sandbox testing, use:
   - Business Shortcode: `174379`
   - Passkey: Provided in your app dashboard

#### **Step 2: Configure Environment Variables**
```env
MPESA_ENVIRONMENT=sandbox
MPESA_CONSUMER_KEY=your_consumer_key
MPESA_CONSUMER_SECRET=your_consumer_secret
MPESA_BUSINESS_SHORTCODE=174379
MPESA_PASSKEY=your_passkey
MPESA_CALLBACK_URL=https://yourdomain.com/api/mpesa/callback
```

#### **Step 3: Test Configuration**
```bash
node test-mpesa.js
```

### **Payment Flow**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer   â”‚
â”‚  Places     â”‚
â”‚  Order      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Enter      â”‚
â”‚  M-PESA     â”‚
â”‚  Number     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STK Push   â”‚
â”‚  Sent to    â”‚
â”‚  Phone      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer   â”‚
â”‚  Enters PIN â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Payment    â”‚
â”‚  Confirmed  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Order      â”‚
â”‚  Processed  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **API Endpoints**

#### **Initiate Payment**
```http
POST /api/mpesa/stkpush
Content-Type: application/json

{
  "phone": "254712345678",
  "amount": 800,
  "accountReference": "ORDER123"
}
```

#### **Query Payment Status**
```http
POST /api/mpesa/query
Content-Type: application/json

{
  "checkoutRequestId": "ws_CO_250220261234567891"
}
```

### **Testing with Sandbox**
- Use test phone: `254708374149`
- Test PIN: `174379`
- Amounts are simulated, no real money deducted

---

## **Customer Portal**

### **Features**
- âœ… Menu browsing with categories
- âœ… Shopping cart functionality
- âœ… M-PESA payment integration
- âœ… Table reservations
- âœ… Order tracking
- âœ… Order history
- âœ… User registration/login
- âœ… Password recovery
- âœ… Profile management
- âœ… Bilingual (English/Swahili)

### **Authentication Flow**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Visitor    â”‚
â”‚  Browses    â”‚
â”‚  Menu       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Attempts   â”‚
â”‚  Action     â”‚
â”‚  (Order/     â”‚
â”‚  Reserve)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Login/     â”‚
â”‚  Register   â”‚
â”‚  Required   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Authenticatedâ”‚
â”‚  User       â”‚
â”‚  Proceeds   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Customer Registration**
```http
POST /api/customer/auth/register
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com",
  "password": "password123",
  "phone": "0712345678",
  "address": "Nairobi, Kenya"
}
```

### **Customer Login**
```http
POST /api/customer/auth/login
Content-Type: application/json

{
  "email": "john@example.com",
  "password": "password123"
}
```

### **Place Order**
```http
POST /api/orders
Authorization: Bearer <customer_token>
Content-Type: application/json

{
  "items": [
    {
      "menuItemId": "65f1a2b3c4d5e6f7a8b9c0d2",
      "quantity": 2
    }
  ],
  "orderType": "takeaway",
  "paymentMethod": "M-PESA"
}
```

### **Track Order**
```http
GET /api/orders/track/ORD24020001?phone=0712345678
```

### **View Order History**
```http
GET /api/orders/my-orders
Authorization: Bearer <customer_token>
```

---

## **Troubleshooting**

### **Common Issues & Solutions**

#### **Issue: Cannot connect to MongoDB**
**Solution:**
```bash
# Check if MongoDB is running
netstat -an | findstr :27017

# Start MongoDB
mongod

# Check connection string in .env
echo $MONGODB_URI
```

#### **Issue: 404 API Endpoints**
**Solution:**
- Verify server is running on correct port
- Check API_URL in frontend (`/api` not `localhost:5000/api`)
- Ensure all routes are properly imported in server.js

#### **Issue: CORS Errors**
**Solution:**
```javascript
// In server.js
app.use(cors({
    origin: '*',
    credentials: true
}));
```

#### **Issue: M-PESA STK Push Fails**
**Solution:**
```bash
# Test M-PESA configuration
node test-mpesa.js

# Check .env for correct credentials
# Ensure phone number format is 254XXXXXXXXX
# Verify sandbox environment is accessible
```

#### **Issue: Order Validation Error**
**Solution:**
- Ensure all required fields are provided
- Check that `orderNumber` is being generated in pre-save hook
- Verify items array is not empty

#### **Issue: Login Fails**
**Solution:**
```bash
# Run seed to create admin user
node seed.js

# Check if user exists in database
mongosh
use restomanagerke
db.users.find({email: "davismcintyre5@gmail.com"})
```

#### **Issue: Dashboard Not Loading**
**Solution:**
- Check browser console for errors
- Verify token is valid
- Clear localStorage and login again
- Ensure all script tags are properly closed

#### **Issue: Print Dialog Appears on Login**
**Solution:**
- Remove any stray `window.print()` calls
- Check report generation functions
- Ensure print only triggered by button clicks

---

## **Support & Contact**

### **Developer Contact**
- **Developer**: Davix HDM
- **Email**: davismcintyre5@gmail.com
- **Phone**: 0768784909
- **WhatsApp**: 0768784909

### **Technical Support**
For technical issues, please contact:
- **Email**: support@restomanagerke.com
- **Response Time**: Within 24 hours
- **Support Hours**: Monday-Friday, 8:00 AM - 6:00 PM EAT

### **Bug Reports**
Please report bugs via email with:
1. Description of the issue
2. Steps to reproduce
3. Screenshots if applicable
4. Browser and version
5. Date and time of occurrence

### **Feature Requests**
We welcome feature suggestions! Send your ideas to:
- **Email**: features@restomanagerke.com
- Include detailed description of the feature
- Explain the benefit to your restaurant

---

## **Version History**

| Version | Date | Changes |
|---------|------|---------|
| 1.0.0 | Jan 2026 | Initial release |
| 1.1.0 | Jan 2026 | Added M-PESA integration |
| 1.2.0 | Feb 2026 | Added customer portal |
| 1.3.0 | Feb 2026 | Added reservations system |
| 2.0.0 | Feb 2026 | Complete overhaul with new UI |
| 2.1.0 | Feb 2026 | Added payroll module |
| 2.2.0 | Feb 2026 | Added reports generation |
| 3.0.0 | Feb 2026 | Full system with all features |

---

## **License**

MIT License

Copyright (c) 2026 Davix HDM

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

---

## **Acknowledgments**

- Safaricom Developer Program for M-PESA API
- MongoDB for database
- Express.js community
- Font Awesome for icons
- Google Fonts for Inter font
- All contributors and testers

---

**Â© 2026 RestoManagerKe. All rights reserved.**
**Developed with â¤ï¸ in Kenya by Davix HDM**